<!-- 導航欄 -->
<nav class="navbar">
    <div class="nav-container">
        <a href="/" class="nav-brand">TYNLC管理系統</a>
        <button class="nav-toggle" onclick="toggleNav()">☰</button>
        <div class="nav-links" id="navLinks">
            <a href="/attendance/query" class="nav-link">出席查詢</a>
            <a href="/attendance/report" class="nav-link">民數回報</a>
            {% if request.session.get('user_id') %}
                <a href="/user/create" class="nav-link">新增使用者</a>
                <a href="/organization-unit/create" class="nav-link">新增組織</a>
                <div class="user-info">
                    歡迎，{{ request.session.get('user_name') }}
                    <form method="POST" action="/logout" style="display: inline;">
                        <button type="submit" class="logout-btn">登出</button>
                    </form>
                </div>
            {% else %}
                <a href="/login" class="nav-link">登入</a>
                <a href="/register" class="nav-link">註冊</a>
            {% endif %}
        </div>
    </div>
</nav>

<script>
function toggleNav() {
    const navLinks = document.getElementById('navLinks');
    navLinks.classList.toggle('active');
}

// Close navigation when clicking outside
document.addEventListener('DOMContentLoaded', function() {
    const navLinks = document.getElementById('navLinks');
    const navToggle = document.querySelector('.nav-toggle');
    
    // Close nav when clicking outside
    document.addEventListener('click', function(event) {
        const isClickInsideNav = navLinks.contains(event.target);
        const isClickOnToggle = navToggle.contains(event.target);
        
        if (!isClickInsideNav && !isClickOnToggle && navLinks.classList.contains('active')) {
            navLinks.classList.remove('active');
        }
    });
    
    // Close nav when touching outside (for touch devices)
    document.addEventListener('touchstart', function(event) {
        const isClickInsideNav = navLinks.contains(event.target);
        const isClickOnToggle = navToggle.contains(event.target);
        
        if (!isClickInsideNav && !isClickOnToggle && navLinks.classList.contains('active')) {
            navLinks.classList.remove('active');
        }
    });
    
    // Close nav when clicking on nav links (mobile)
    const navLinksElements = navLinks.querySelectorAll('.nav-link');
    navLinksElements.forEach(function(link) {
        link.addEventListener('click', function() {
            if (window.innerWidth <= 768) {
                navLinks.classList.remove('active');
            }
        });
    });
});
</script>